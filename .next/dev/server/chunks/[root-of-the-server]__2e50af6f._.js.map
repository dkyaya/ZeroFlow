{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/joachimjohnson/Documents/comp-sci/ZeroFlow/lib/prisma.js"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\n\nlet prisma;\n\n// Prevent multiple Prisma instances in dev (Next.js hot reload)\nif (process.env.NODE_ENV === \"production\") {\n  prisma = new PrismaClient();\n} else {\n  if (!global.prisma) {\n    global.prisma = new PrismaClient();\n  }\n  prisma = global.prisma;\n}\n\nexport { prisma };\n"],"names":[],"mappings":";;;;AAAA;;AAEA,IAAI;AAEJ,gEAAgE;AAChE;;KAEO;IACL,IAAI,CAAC,yDAAO,MAAM,EAAE;QAClB,yDAAO,MAAM,GAAG,IAAI,6IAAY;IAClC;IACA,SAAS,yDAAO,MAAM;AACxB"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Users/joachimjohnson/Documents/comp-sci/ZeroFlow/app/api/food/log/route.js"],"sourcesContent":["// app/api/food/log/route.js\n// Logs a food entry using the USDA search results (calories + macros + quantity).\n\nimport { NextResponse } from \"next/server\";\nimport { prisma } from \"@/lib/prisma\";\n\nexport async function POST(request) {\n  try {\n    const body = await request.json();\n    const {\n      fdcId = null,\n      name,\n      calories,\n      protein = 0,\n      carbs = 0,\n      fat = 0,\n      quantity = 1,\n    } = body || {};\n\n    if (!name || calories === undefined) {\n      return NextResponse.json(\n        { error: \"Food name and calories are required\" },\n        { status: 400 }\n      );\n    }\n\n    const qty = parseInt(quantity, 10);\n    if (!Number.isInteger(qty) || qty <= 0) {\n      return NextResponse.json(\n        { error: \"Quantity must be a positive integer\" },\n        { status: 400 }\n      );\n    }\n\n    const calPerUnit = Number(calories);\n    if (isNaN(calPerUnit) || calPerUnit <= 0) {\n      return NextResponse.json(\n        { error: \"Calories must be a positive number\" },\n        { status: 400 }\n      );\n    }\n\n    const macroProtein = Math.round(Number(protein) || 0);\n    const macroCarbs = Math.round(Number(carbs) || 0);\n    const macroFat = Math.round(Number(fat) || 0);\n\n    // Resolve the active user (most recent) or create a placeholder\n    let activeUser = await prisma.user.findFirst({\n      orderBy: { id: \"desc\" },\n      select: { id: true },\n    });\n\n    if (!activeUser) {\n      activeUser = await prisma.user.create({\n        data: {\n          firstName: \"User\",\n          lastName: \"Placeholder\",\n          email: `placeholder-${Date.now()}@example.com`,\n          password: \"placeholder\",\n          height: 0,\n          weight: 0,\n          age: 0,\n          sex: \"unknown\",\n          goal: \"maintain\",\n          activityLevel: \"light\",\n          unitSystem: \"metric\",\n        },\n        select: { id: true },\n      });\n    }\n\n    const entry = await prisma.dailyFoodLog.create({\n      data: {\n        userId: activeUser.id,\n        foodId: fdcId ? Number(fdcId) : null,\n        name: name.trim(),\n        calories: Math.round(calPerUnit),\n        protein: macroProtein,\n        carbs: macroCarbs,\n        fat: macroFat,\n        quantity: qty,\n        date: new Date(),\n      },\n    });\n\n    return NextResponse.json({ success: true, entry }, { status: 201 });\n  } catch (err) {\n    console.error(\"Food log error:\", err);\n    return NextResponse.json(\n      { error: \"Failed to log food\" },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"AAAA,4BAA4B;AAC5B,kFAAkF;;;;;AAElF;AACA;;;AAEO,eAAe,KAAK,OAAO;IAChC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EACJ,QAAQ,IAAI,EACZ,IAAI,EACJ,QAAQ,EACR,UAAU,CAAC,EACX,QAAQ,CAAC,EACT,MAAM,CAAC,EACP,WAAW,CAAC,EACb,GAAG,QAAQ,CAAC;QAEb,IAAI,CAAC,QAAQ,aAAa,WAAW;YACnC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsC,GAC/C;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,MAAM,SAAS,UAAU;QAC/B,IAAI,CAAC,OAAO,SAAS,CAAC,QAAQ,OAAO,GAAG;YACtC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAsC,GAC/C;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,aAAa,OAAO;QAC1B,IAAI,MAAM,eAAe,cAAc,GAAG;YACxC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAqC,GAC9C;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,eAAe,KAAK,KAAK,CAAC,OAAO,YAAY;QACnD,MAAM,aAAa,KAAK,KAAK,CAAC,OAAO,UAAU;QAC/C,MAAM,WAAW,KAAK,KAAK,CAAC,OAAO,QAAQ;QAE3C,gEAAgE;QAChE,IAAI,aAAa,MAAM,yHAAM,CAAC,IAAI,CAAC,SAAS,CAAC;YAC3C,SAAS;gBAAE,IAAI;YAAO;YACtB,QAAQ;gBAAE,IAAI;YAAK;QACrB;QAEA,IAAI,CAAC,YAAY;YACf,aAAa,MAAM,yHAAM,CAAC,IAAI,CAAC,MAAM,CAAC;gBACpC,MAAM;oBACJ,WAAW;oBACX,UAAU;oBACV,OAAO,CAAC,YAAY,EAAE,KAAK,GAAG,GAAG,YAAY,CAAC;oBAC9C,UAAU;oBACV,QAAQ;oBACR,QAAQ;oBACR,KAAK;oBACL,KAAK;oBACL,MAAM;oBACN,eAAe;oBACf,YAAY;gBACd;gBACA,QAAQ;oBAAE,IAAI;gBAAK;YACrB;QACF;QAEA,MAAM,QAAQ,MAAM,yHAAM,CAAC,YAAY,CAAC,MAAM,CAAC;YAC7C,MAAM;gBACJ,QAAQ,WAAW,EAAE;gBACrB,QAAQ,QAAQ,OAAO,SAAS;gBAChC,MAAM,KAAK,IAAI;gBACf,UAAU,KAAK,KAAK,CAAC;gBACrB,SAAS;gBACT,OAAO;gBACP,KAAK;gBACL,UAAU;gBACV,MAAM,IAAI;YACZ;QACF;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM;QAAM,GAAG;YAAE,QAAQ;QAAI;IACnE,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,mBAAmB;QACjC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAqB,GAC9B;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}